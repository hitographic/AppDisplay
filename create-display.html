<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="theme-color" content="#e31e24">
    <title>Create Display - MDS Track</title>
    <link rel="icon" type="image/png" href="assets/Favicon MDS.png">
    <link rel="apple-touch-icon" href="assets/App MDS.png">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">
            <img src="assets/Navigation MDS.png" alt="MDS" class="nav-logo">
        </div>
        <div class="nav-user">
            <span id="userName">User</span>
            <button class="btn-logout" onclick="goBack()">
                <i class="fas fa-arrow-left"></i> Kembali
            </button>
        </div>
    </nav>
    <main style="max-width: 900px; margin: 0 auto; padding: 30px;">
        <div class="page-header">
            <h1><i class="fas fa-camera"></i> Create Display</h1>
            <p>Buat data display baru dengan memilih foto dari master data</p>
        </div>
        <div id="googleDriveAlert" class="google-drive-alert" style="display: none;">
            <div class="alert-icon"><i class="fas fa-exclamation-triangle"></i></div>
            <div class="alert-content">
                <h3>Google Drive: Tidak Terkoneksi</h3>
                <p>Hubungkan ke Google Drive untuk memilih foto master data.</p>
            </div>
            <button class="btn-connect-drive" onclick="connectGoogleDrive()">
                <i class="fas fa-plug"></i> Hubungkan
            </button>
        </div>
        <div id="googleDriveConnected" class="google-drive-connected" style="display: none;">
            <div class="alert-icon"><i class="fas fa-check-circle"></i></div>
            <div class="alert-content">
                <h3>Google Drive: Terkoneksi</h3>
                <p>Siap membuat display baru.</p>
            </div>
        </div>
        <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); margin-bottom: 20px;">
            <h2 style="margin: 0 0 20px 0; font-size: 1.1rem;"><i class="fas fa-info-circle"></i> Informasi Display</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-tag"></i> Flavor</label>
                    <input type="text" id="flavor" placeholder="Contoh: CR-MA 5x8" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-barcode"></i> Nomor Material</label>
                    <input type="text" id="nomorMaterial" placeholder="Contoh: 234563" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                </div>
            </div>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-globe"></i> Negara</label>
                    <input type="text" id="negara" placeholder="Contoh: MALAYSIA" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-calendar"></i> Tanggal</label>
                    <input type="date" id="tanggal" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                </div>
            </div>
        </div>
        <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
            <h2 style="margin: 0 0 20px 0; font-size: 1.1rem;"><i class="fas fa-images"></i> Pilih Foto dari Master Data</h2>
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-pepper-hot"></i> Bumbu</label>
                    <select id="bumbu" onchange="handleDropdownChange('bumbu')" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <option value="">-- Pilih Bumbu --</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-oil-can"></i> M. Bumbu</label>
                    <select id="mBumbu" onchange="handleDropdownChange('mBumbu')" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <option value="">-- Pilih M. Bumbu --</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-barcode"></i> SI</label>
                    <select id="si" onchange="handleDropdownChange('si')" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <option value="">-- Pilih SI --</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-box"></i> Karton</label>
                    <select id="karton" onchange="handleDropdownChange('karton')" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <option value="">-- Pilih Karton --</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-tag"></i> Etiket</label>
                    <select id="etiket" onchange="handleDropdownChange('etiket')" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <option value="">-- Pilih Etiket --</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-cubes"></i> Etiket Banded</label>
                    <select id="etiketBanded" onchange="handleDropdownChange('etiketBanded')" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <option value="">-- Pilih Etiket Banded --</option>
                    </select>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600;"><i class="fas fa-tape"></i> Plakban</label>
                    <select id="plakban" onchange="handleDropdownChange('plakban')" style="width: 100%; padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px;">
                        <option value="">-- Pilih Plakban --</option>
                    </select>
                </div>
            </div>
            <div style="display: flex; gap: 15px; justify-content: flex-end; margin-top: 25px;">
                <button onclick="saveTemporary()" style="background: #f39c12; color: white; padding: 12px 30px; border: none; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer;">
                    <i class="fas fa-save"></i> Simpan Sementara
                </button>
                <button id="btnPreview" onclick="showPreview()" disabled style="background: #3498db; color: white; padding: 12px 30px; border: none; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer;">
                    <i class="fas fa-eye"></i> Preview
                </button>
                <button id="btnSaveAll" onclick="saveAll()" disabled style="background: #27ae60; color: white; padding: 12px 30px; border: none; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer;">
                    <i class="fas fa-check-circle"></i> Simpan Semua
                </button>
            </div>
        </div>
    </main>
    <div id="previewModal" style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); display: none; align-items: center; justify-content: center; z-index: 1000; padding: 20px;">
        <div style="background: white; border-radius: 12px; width: 100%; max-width: 1000px; max-height: 90vh; overflow-y: auto;">
            <div style="padding: 20px; border-bottom: 1px solid #e0e0e0; display: flex; justify-content: space-between; align-items: center;">
                <h3 style="margin: 0;"><i class="fas fa-images"></i> Preview Foto Display</h3>
                <button onclick="closePreview()" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
            </div>
            <div style="padding: 25px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                        <div><strong>Flavor:</strong> <span id="previewFlavor">-</span></div>
                        <div><strong>Nomor Material:</strong> <span id="previewNomorMaterial">-</span></div>
                        <div><strong>Negara:</strong> <span id="previewNegara">-</span></div>
                        <div><strong>Tanggal:</strong> <span id="previewTanggal">-</span></div>
                    </div>
                </div>
                <div id="previewPhotos" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 20px;"></div>
            </div>
            <div style="padding: 20px; border-top: 1px solid #e0e0e0; display: flex; justify-content: flex-end; gap: 15px;">
                <button onclick="closePreview()" style="background: #95a5a6; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer;">Tutup</button>
                <button onclick="saveAll()" style="background: #27ae60; color: white; padding: 10px 25px; border: none; border-radius: 8px; cursor: pointer;">
                    <i class="fas fa-check-circle"></i> Simpan Semua
                </button>
            </div>
        </div>
    </div>
    <div id="loadingOverlay" class="loading-overlay"><div class="loading-spinner"><i class="fas fa-spinner"></i><p id="loadingText">Memuat...</p></div></div>
    <div id="toast-container"></div>
    <footer class="app-footer"><p><span>&copy; <span id="footerYear"></span></span><span class="footer-version">ver.2.0.0</span><span>by <span class="footer-brand">DuoBingo</span> for <span class="footer-company">Indofood</span></span></p></footer>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://accounts.google.com/gsi/client"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/create-display.js?v=2.0"></script>
    <script>document.getElementById('footerYear').textContent = new Date().getFullYear(); document.getElementById('tanggal').valueAsDate = new Date();</script>
</body>
</html>
